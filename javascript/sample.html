<!doctype html>
<html lang="ko">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Scroll Draw â€“ Vertical Route with 5 Dots</title>
    <style>
        :root {
            --bg: #f7f9f5;
            --line: #78c850;
            /* ì˜ë¡œìš°ê·¸ë¦° ë¼ì¸ ìƒ‰ */
            --dot: #111;
            /* ì  ìƒ‰ */
            --muted: #7b8b8c;
        }

        * {
            box-sizing: border-box
        }

        body {
            margin: 0;
            font-family: system-ui, Arial, Helvetica, sans-serif;
            background: var(--bg);
            color: #111
        }

        /* ìƒë‹¨ ì¸íŠ¸ë¡œ ì˜ì—­ (ìŠ¤í¬ë¡¤ ì‹œì‘ ì „) */
        header {
            min-height: 100vh;
            display: grid;
            place-items: center;
            padding: 3rem 1.5rem;
            text-align: center;
        }

        header h1 {
            margin: 0 0 .5rem;
            font-size: clamp(28px, 5vw, 48px)
        }

        header p {
            margin: 0;
            color: var(--muted)
        }

        /* íŠ¸ë™ ì„¹ì…˜: stickyë¡œ SVGë¥¼ ê³ ì •í•˜ê³  ì„¹ì…˜ ë†’ì´ë§Œí¼ ê·¸ë ¤ì§€ê²Œ í•¨ */
        section#track {
            position: relative;
            min-height: 260vh;
            /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ ê¸¸ì´ (ì›í•˜ë©´ ëŠ˜ë¦¬ì„¸ìš”) */
            background: #fff;
        }

        .sticky-wrap {
            position: sticky;
            top: 0;
            height: 100vh;
            display: grid;
            place-items: center;
        }

        /* SVG í¬ê¸°ì™€ ë¼ì¸ ìŠ¤íƒ€ì¼ */
        svg {
            width: min(720px, 92vw);
            height: auto;
            overflow: visible
        }

        .route {
            fill: none;
            stroke: var(--line);
            stroke-width: 10;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: drop-shadow(0 2px 0 rgba(0, 0, 0, .05));
        }

        /* ì (5ê°œ)ê³¼ ë¼ë²¨ */
        .dot {
            fill: var(--dot);
            opacity: .2;
            transition: opacity .35s ease, r .35s ease
        }

        .dot.show {
            opacity: 1
        }

        .label {
            font: 600 14px/1.2 system-ui, Arial, Helvetica, sans-serif;
            fill: #333;
            opacity: .2;
            transition: opacity .35s ease, transform .35s ease;
        }

        .label.show {
            opacity: 1;
            transform: translateY(-2px)
        }

        /* ì ‘ê·¼ì„± ëŒ€ë¹„: í¬ì»¤ìŠ¤ ë§ */
        .focusable:focus {
            outline: 3px solid #222;
            outline-offset: 4px;
            border-radius: 6px
        }

        /* í•˜ë‹¨ ë§ˆë¬´ë¦¬ ì„¹ì…˜ */
        footer {
            padding: 4rem 1.5rem 6rem;
            text-align: center;
            background: #fff;
        }

        .hint {
            color: var(--muted);
            margin-top: .25rem
        }
    </style>
</head>

<body>
    <header>
        <div>
            <h1>ìŠ¤í¬ë¡¤í•˜ë©´ â€˜ì„¸ë¡œ ê¸¸â€™ì´ ê·¸ë ¤ì§‘ë‹ˆë‹¤</h1>
            <p>í¬ì¸íŠ¸ 5ê°œë¥¼ ì§€ë‚˜ë©° ë¼ë²¨ì´ ì°¨ë¡€ëŒ€ë¡œ ë‚˜íƒ€ë‚˜ìš”.</p>
        </div>
    </header>

    <section id="track" aria-label="ì„¸ë¡œ ë¼ì¸ ìŠ¤í¬ë¡¤ íŠ¸ë™">
        <div class="sticky-wrap">
            <!-- ì„¸ë¡œ ë¼ì¸: xëŠ” ê³ ì •(360), yë§Œ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ë©° ì•½ê°„ì˜ ê³¡ì„ ì„ ì¤Œ -->
            <svg viewBox="0 0 720 1200" role="img" aria-label="ì„¸ë¡œ ê²½ë¡œì™€ 5ê°œì˜ ì²´í¬í¬ì¸íŠ¸">
                <!-- ê²½ë¡œëŠ” ìœ„ì—ì„œ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ëŠ” S-ì»¤ë¸Œ -->
                <path id="route" class="route" d="M360,60
             C360,160 300,240 360,340
             S420,540 360,740
             S300,940 360,1140" />

                <!-- ì  5ê°œ (y ìœ„ì¹˜ë§Œ ë‹¤ë¥´ê²Œ, xëŠ” 360ì„ ê¸°ì¤€ìœ¼ë¡œ ì•½ê°„ ì¢Œìš°ë¡œ ë³€ì£¼) -->
                <circle class="dot" id="dot1" cx="360" cy="140" r="6" />
                <text class="label" x="380" y="140">Start</text>

                <circle class="dot" id="dot2" cx="330" cy="360" r="6" />
                <text class="label" x="350" y="360">Checkpoint 2</text>

                <circle class="dot" id="dot3" cx="390" cy="580" r="6" />
                <text class="label" x="410" y="580">Checkpoint 3</text>

                <circle class="dot" id="dot4" cx="330" cy="800" r="6" />
                <text class="label" x="350" y="800">Checkpoint 4</text>

                <circle class="dot" id="dot5" cx="360" cy="1020" r="6" />
                <text class="label" x="380" y="1020">Goal</text>
            </svg>
        </div>
    </section>

    <footer>
        <h2 class="focusable" tabindex="0">ëê¹Œì§€ ë„ë‹¬í–ˆìŠµë‹ˆë‹¤ ğŸ‰</h2>
        <p class="hint">CSS/JSë¡œ ì  í¬ê¸°, ë¼ë²¨, ìƒ‰ìƒì„ ë§ˆìŒëŒ€ë¡œ ë°”ê¿”ë³´ì„¸ìš”.</p>
    </footer>

    <script>
        (() => {
            const section = document.getElementById('track');
            const path = document.getElementById('route');
            const dots = [...document.querySelectorAll('.dot')];
            const labels = [...document.querySelectorAll('.label')];

            // ê²½ë¡œ ì´ ê¸¸ì´ êµ¬í•´ì„œ dash ì• ë‹ˆë©”ì´ì…˜ ì„¸íŒ…
            const totalLen = path.getTotalLength();
            path.style.strokeDasharray = totalLen;
            path.style.strokeDashoffset = totalLen;

            // ê° ì ì´ ê²½ë¡œ ìƒì—ì„œ â€œëª‡ % ì§€ì â€ì— ìˆëŠ”ì§€ ëŒ€ëµ ì„¤ì •(0~1)
            // ì•„ë˜ ê°’ì€ yì¢Œí‘œ ê¸°ì¤€ìœ¼ë¡œ ê°ìœ¼ë¡œ ë§ì¶˜ ë¹„ìœ¨. í•„ìš”í•˜ë©´ ë¯¸ì„¸ì¡°ì •í•˜ì„¸ìš”.
            const checkpoints = [0.08, 0.30, 0.50, 0.70, 0.88];

            let ticking = false;

            function update() {
                const rect = section.getBoundingClientRect();
                const vh = window.innerHeight;
                const scrollable = rect.height - vh; // stickyì—ì„œ ì‹¤ì œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ê±°ë¦¬
                const passed = Math.min(Math.max(-rect.top, 0), scrollable);
                const progress = scrollable > 0 ? (passed / scrollable) : 0; // 0~1

                // ê¸¸ ê·¸ë¦¬ê¸°: ì§„í–‰ë¥ ë§Œí¼ dashoffset ê°ì†Œ
                path.style.strokeDashoffset = totalLen * (1 - progress);

                // ì§„í–‰ë¥ ì— ë”°ë¼ ì /ë¼ë²¨ ë…¸ì¶œ
                checkpoints.forEach((p, i) => {
                    const show = progress >= p;
                    dots[i].classList.toggle('show', show);
                    labels[i].classList.toggle('show', show);

                    // ì  í¬ê¸° ì‚´ì§ ì• ë‹ˆë©”ì´ì…˜ (ê°€ì‹œì„±)
                    dots[i].setAttribute('r', show ? 7.5 : 6);
                });

                ticking = false;
            }

            function onScroll() {
                if (!ticking) {
                    requestAnimationFrame(update);
                    ticking = true;
                }
            }

            // ë°˜ì‘í˜•: ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ê¸¸ì´ ì¬ê³„ì‚°
            window.addEventListener('resize', () => {
                const len = path.getTotalLength();
                path.style.strokeDasharray = len;
                // í˜„ì¬ ì§„í–‰ë¥  ë¹„ìœ¨ë¡œ ë‹¤ì‹œ ì˜¤í”„ì…‹ ë°˜ì˜
                const rect = section.getBoundingClientRect();
                const vh = window.innerHeight;
                const scrollable = rect.height - vh;
                const passed = Math.min(Math.max(-rect.top, 0), scrollable);
                const progress = scrollable > 0 ? (passed / scrollable) : 0;
                path.style.strokeDashoffset = len * (1 - progress);
            });

            window.addEventListener('scroll', onScroll, { passive: true });
            update();
        })();
    </script>
</body>

</html>